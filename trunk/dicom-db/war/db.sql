CONNECT 'jdbc:derby://localhost:1527//WORKDB/WEBDICOM;create=true';

CREATE TABLE WIBDICOM.DCMFILES (
	ID INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
	DCM_FILE_NAME VARCHAR(512) NOT NULL,
	PATIENT_BIRTH_DATE DATE NOT NULL,
	PATIENT_NAME VARCHAR(512) NOT NULL,
	STUDY_DATE DATE NOT NULL,
	CONSTRAINT WIBDICOM.PK_DCMFILES PRIMARY KEY (ID),
	UNIQUE (DCM_FILE_NAME)
);

CREATE TABLE WIBDICOM.STUDIES (
	ID INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
	FID INTEGER NOT NULL,	
	DCM_FILE_NAME VARCHAR(512) NOT NULL,
	PATIENT_BIRTH_DATE DATE NOT NULL,
	PATIENT_NAME VARCHAR(512) NOT NULL,
	STUDY_DATE DATE NOT NULL,
	CONSTRAINT WIBDICOM.PK_STUDIES PRIMARY KEY (ID),
	CONSTRAINT WIBDICOM.FK_STUDIES_DCMFILES FOREIGN KEY (FID) REFERENCES WIBDICOM.DCMFILES (ID),
	UNIQUE (DCM_FILE_NAME)
);

CREATE TABLE WIBDICOM.SERIES (
	ID INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
	FID INTEGER NOT NULL,	
	DCM_FILE_NAME VARCHAR(512) NOT NULL,
	PATIENT_BIRTH_DATE DATE NOT NULL,
	PATIENT_NAME VARCHAR(512) NOT NULL,
	STUDY_DATE DATE NOT NULL,
	CONSTRAINT WIBDICOM.PK_SERIES PRIMARY KEY (ID),
	CONSTRAINT WIBDICOM.FK_SERIES_STUDIES FOREIGN KEY (FID) REFERENCES WIBDICOM.STUDIES (ID),
	UNIQUE (DCM_FILE_NAME)
);

CREATE TABLE WIBDICOM.IMAGES (
	ID INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
	FID INTEGER NOT NULL,	
	DCM_FILE_NAME VARCHAR(512) NOT NULL,
	PATIENT_BIRTH_DATE DATE NOT NULL,
	PATIENT_NAME VARCHAR(512) NOT NULL,
	STUDY_DATE DATE NOT NULL,
	CONSTRAINT WIBDICOM.PK_IMAGES PRIMARY KEY (ID),
	CONSTRAINT WIBDICOM.FK_IMAGES_SERIES FOREIGN KEY (FID) REFERENCES WIBDICOM.SERIES (ID),
	UNIQUE (DCM_FILE_NAME)
); 
